<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
    <style>
        body{
            background: linear-gradient(135deg, #d3d9ef3f 0%, #dbcfe688 100%);
            min-height: 100vh;
            padding: 20px 0;
        }
        .bg{
            /* background: linear-gradient(135deg, #d3d9ef3f 0%, #dbcfe688 100%); */
            padding: 16px;
            border-radius: 14px;
            /* box-shadow: 0 8px 22px rgba(0, 0, 0, 0.08); */
        }
/* .table th,
.table td {
    font-size: 0.9rem;
    vertical-align: middle;
}

.table th {
    font-weight: 600;
    color: #2c3e50;
}
.table {
    background-color: rgba(112, 152, 192, 0.65);
    border-radius: 10px;
    overflow: hidden;
} */
.table-hover tbody tr:hover {
    background-color: #f5f7fb;
}

input[type="checkbox"] {
    cursor: pointer;
}
button{
    align-items: center;
    padding: 5px;
    gap: 8px;
    margin-bottom: 15px;
    background: linear-gradient(135deg, #b097eb33 0%, #9fc4e666 100%);
    border: 1px solid rgba(108, 117, 255, 0.35);
    color: #3b3f8c;
    font-weight: 500;
    transition: all 0.25s ease-in-out;
    display: inline-flex;
        }
</style>

    <div class="bg">

    

    <form id="exportForm" method="POST" action="{% url 'export_users_csv' %}">
    {% csrf_token %}

    <!-- <div>
        <h5>Column choice:</h5>
        <label><input type="checkbox" name="columns" value="name" checked> Name</label>
        <label><input type="checkbox" name="columns" value="email" checked> Email</label>
        <label><input type="checkbox" name="columns" value="location"> Location</label>
        <label><input type="checkbox" name="columns" value="gender"> Gender</label>
        <label><input type="checkbox" name="columns" value="college"> College</label>
        <label><input type="checkbox" name="columns" value="cgpa"> CGPA</label>
        <label><input type="checkbox" name="columns" value="skills"> Skills</label>
        <label><input type="checkbox" name="columns" value="additional_skills"> Additional Skills</label>

    </div> -->

    <br>

    <button type="submit" name="export_type" value="selected">Export Selected</button>

    <button type="submit" name="export_type" value="all">
        Export All
    </button>

    <table class="table table-bordered table-hover align-middle">
    <thead class="table-light">
        <tr>
            <th><input type="checkbox" id="selectAll"></th>
            <th>ID</th>
            <th><label><input type="checkbox" name="columns" value="name" checked> Name</label></th>
            <th><input type="checkbox" name="columns" value="email" checked> Email</th>
            <th><input type="checkbox" name="columns" value="location"> Location</th>
            <th><input type="checkbox" name="columns" value="gender"> Gender</th>
            <th><input type="checkbox" name="columns" value="college"> College</th>
            <th><input type="checkbox" name="columns" value="cgpa"> CGPA</th>
            <th><input type="checkbox" name="columns" value="skills"> Skills</th>
            <th><input type="checkbox" name="columns" value="additional_skills"> Additional Skills</th>

        </tr>
    </thead>
    <tbody>
        {% for row in user_data %}
        <tr>
            <td><input type="checkbox" name="user_ids" value="{{ row.user.id }}"></td>
            <td>{{ row.user.id }}</td>
            <td>{{ row.user.first_name }} {{ row.user.last_name }}</td>
            <td>{{ row.user.email }}</td>

            <td>{{ row.additionals.location|default:"-" }}</td>
            <td>{{ row.additionals.gender|default:"-" }}</td>
            <td>{{ row.additionals.college|default:"-" }}</td>
            <td>{{ row.additionals.cgpa|default:"-" }}</td>

            <td>
                {% if row.additionals and row.additionals.skills %}
                    {{ row.additionals.skills|join:", " }}
                {% else %}
                    -
                {% endif %}
            </td>
            <td>
                {% if row.additionals and row.additionals.additional_skills %}
                    {{ row.additionals.additional_skills|join:", " }}
                {% else %}
                    -
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</form>
</div>
<!-- <script>
document.querySelector('[value="all"]').addEventListener("click", function () {
    document.querySelectorAll('input[name="columns"]').forEach(cb => {
        cb.checked = true;
    });
});
</script> -->
<script>
document.addEventListener("DOMContentLoaded", function () {

    const selectAll = document.getElementById("selectAll");
    const rows = document.querySelectorAll('input[name="user_ids"]');

    selectAll.addEventListener("change", function () {
        rows.forEach(cb => cb.checked = this.checked);
    });

    rows.forEach(cb => {
        cb.addEventListener("change", function () {
            selectAll.checked = [...rows].every(r => r.checked);
        });
    });

});

</script>


</body>
</html>